ifelse(datosMujeres$GRUPEDAD==3, "30 a 39 años",
ifelse(datosMujeres$GRUPEDAD == 4, "40 a 49 años","50 a 59 años"))))
datosMujeresAdult <- datosMujeres[which(datosMujeres$GRUPEDAD != 1),]
datosMujeresAdult$sector <- ifelse(datosMujeresAdult$NIVEL_INSTRUCCION_AGRUPADO < 3, "Popular","Medio/Alto")
datosMujeresAdult= datosMujeresAdult[!is.na(datosMujeresAdult$MEP11),]
totalEND<- nrow(datosMujeres[datosMujeres$MEP11 == "Embarazo no deseado",])
totalEND<- nrow(datosMujeres[datosMujeres$MEP11 == "Embarazo no deseado",])
totalEND<- nrow(datosMujeres[datosMujeres$MEP11 == "Embarazo no deseado",])
df_corte$canta <- 2013-df_corte$MEP10
summary(df_corte$canta)
df_corte$edadUH <- df_corte$EDAD-df_corte$canta
summary(df_corte$edadUH)
df_corte$GRUPEDAD_UH <- ifelse(df_corte$edadUH<20,"13 a 19 años",
ifelse(df_corte$edadUH<30, "20 a 29 años",
ifelse(df_corte$edadUH<40,"30 a 39 años",
ifelse(df_corte$edadUH<50,"40 a 49 años"))))
end_1 <- nrow(df_corte[df_corte$GRUPEDAD_UH=="13 a 19 años",])
end_2 <- nrow(df_corte[df_corte$GRUPEDAD_UH=="20 a 29 años",])
end_3 <- nrow(df_corte[df_corte$GRUPEDAD_UH=="30 a 39 años",])
end_4 <- nrow(df_corte[df_corte$GRUPEDAD_UH=="40 a 49 años",])
agrup <- c("13 a 19 años","20 a 29 años","30 a 39 años","40 a 49 años")
edades <- c(end_1,end_2,end_3,end_4)
end_grupE <- as.data.frame(cbind(agrup,edades,totalEND))
p <- plot_ly(end_grupE, labels = ~agrup, values = ~edades, type = 'pie') %>%
layout(title = "¿Los embarazos no deseados son solo una problemática adolescente?",
xaxis = list(showgrid = FALSE, zeroline = FALSE, showticklabels = FALSE),
yaxis = list(showgrid = FALSE, zeroline = FALSE, showticklabels = FALSE))
g3<-ggplot(df_corte,aes(x="",y=MEP11, fill=factor(MEP14)))+geom_bar(width=1,stat="identity")
g3<- g3 + coord_polar("y", start=0)
g3
s1 <- nrow(datosMujeresAdult[datosMujeresAdult$sector == "Medio/Alto",])
s2 <- nrow(datosMujeresAdult[datosMujeresAdult$sector == "Popular",])
END_S_1 <- nrow(datosMujeres[datosMujeresAdult$sector == "Medio/Alto" & datosMujeresAdult$MEP11== "Embarazo no deseado",])
END_S_2 <- nrow(datosMujeres[datosMujeresAdult$sector == "Popular" & datosMujeresAdult$MEP11== "Embarazo no deseado",])
embarazosnd_sector <- as.data.frame(rbind(s1,s2))
colnames(embarazosnd_sector)<-c("Cantidad")
embarazosnd_sector$Cant_END <- c(END_S_1,END_S_2)
embarazosnd_sector$tasa <- round(embarazosnd_sector$Cant_END*100/embarazosnd_sector$Cantidad,2)
embarazosnd_sector$total <- c(100)
embarazosnd_sector$sector <- c("Medio/Alto","Popular")
g2<-ggplot(embarazosnd_sector, aes(x="", y=tasa, fill=sector))+geom_bar(width=1,stat="identity")+coord_polar("y", start=0)
plot_ly(embarazosnd_sector, labels = ~sector, values = ~tasa, type = 'pie') %>%
layout(title = "¿Los embarazos no deseados son solo una problemática de mujeres pobres?",
xaxis = list(showgrid = FALSE, zeroline = FALSE, showticklabels = FALSE),
yaxis = list(showgrid = FALSE, zeroline = FALSE, showticklabels = FALSE))
g3<-ggplot(df_corte,aes(x="",y=MEP11, fill=factor(MEP14)))+geom_bar(width=1,stat="identity")
g3<- g3 + coord_polar("y", start=0)
g3
r1 <- nrow(datosMujeres[datosMujeres$MITS19 == 1,])
r2 <- nrow(datosMujeres[datosMujeres$MITS19 == 2,])
pr_relig <- c("Religiosa","Atea")
end_r1 <- nrow(datosMujeres[datosMujeres$MITS19==1 & datosMujeres$MEP11== "Embarazo no deseado",])
end_r2 <- nrow(datosMujeres[datosMujeres$MITS19==2 & datosMujeres$MEP11== "Embarazo no deseado",])
END_relig <-  as.data.frame(cbind(c(r1,r2)))
END_relig$cant_END <- c(end_r1,end_r2)
END_relig$categoria <- pr_relig
END_relig$tasa <- round(END_relig$cant_END*100/END_relig$V1,2)
colnames(END_relig)<-c("Total muestra","Cantidad END","Categoria","Tasa")
plot_ly(END_relig, labels = ~Categoria, values = ~Tasa, type = 'pie') %>%
layout(xaxis = list(showgrid = FALSE, zeroline = FALSE, showticklabels = FALSE),
yaxis = list(showgrid = FALSE, zeroline = FALSE, showticklabels = FALSE))
#al interior de las religiones
re1 <- nrow(datosMujeres[datosMujeres$MITS20== "Católica",])
re2 <- nrow(datosMujeres[datosMujeres$MITS20== "Evangélica",])
end_re1 <- nrow(datosMujeres[datosMujeres$MITS20 == "Católica" & datosMujeres$MEP11 == "Embarazo no deseado",])
end_re2 <- nrow(datosMujeres[datosMujeres$MITS20 == "Evangélica" & datosMujeres$MEP11 == "Embarazo no deseado",])
ggplot(df_corte, aes(x=MEP13))+geom_bar()+facet_grid(MEP14.~)
ggplot(df_corte, aes(x=MEP13))+geom_bar()+facet_grid(MEP14~.)
ggplot(df_corte, aes(x=MEP14),fill=factor(MEP13))+geom_bar()
ggplot(df_corte, aes(x=factor(MEP14)),fill=factor(MEP13))+geom_bar()
ggplot(df_corte, aes(x=factor(MEP14)))+geom_bar(fill=factor(MEP13))
ggplot(df_corte, aes(x=factor(MEP14)))+geom_bar(fill=factor(MEP13))
ggplot(df_corte, aes(x=factor(MEP14)))+geom_bar(fill=factor(df_corte$MEP13))
ggplot(df_corte, aes(x=factor(MEP14)))+geom_bar(aes(fill=factor(df_corte$MEP13)))
ggplot(df_corte, aes(x=factor(MEP14)))+geom_bar(aes(fill=factor(MEP13)))
df_corte= df_corte[!is.na(df_corte$MEP13),]
ggplot(df_corte, aes(x=factor(MEP14)))+geom_bar(aes(fill=factor(MEP13)))
df_corte= df_corte[!(df_corte$MEP13== 9),]
ggplot(df_corte, aes(x=factor(MEP14)))+geom_bar(aes(fill=factor(MEP13)))
g3
rm(list=ls())
setwd("C:/Users/perla/OneDrive/Documents/ssyr/data")
datosMujeres=read.table("ENSSyR_Mujeres_BaseUsuario.txt", header=T, sep="|")
datosMujeres$MEP11 <- ifelse (datosMujeres$MEP11== 1, "Embarazo deseado","Embarazo no deseado" )
datosMujeres= datosMujeres[!is.na(datosMujeres$MEP11),]
df_corte <- datosMujeres[which (datosMujeres$MEP11=="Embarazo no deseado"),]
datosMujeres$MITS20 <- ifelse(datosMujeres$MITS20 == 1, "Católica",
ifelse(datosMujeres$MITS20 == 2, "Evangélica",
ifelse(datosMujeres$MITS20 == 3, "Judía",
ifelse(datosMujeres$MITS20 == 4, "Testigo de Jeohvá",
ifelse(datosMujeres$MITS20 == 5, "Mormón",
ifelse(datosMujeres$MITS20==7, "Adventista", "Otro"))))))
datosMujeres$MEP05 <- ifelse(datosMujeres$MEP05 == 1, "Si",
ifelse(datosMujeres$MEP05 == 2, "No", NA))
datosMujeres$MEP14 <- ifelse(datosMujeres$MEP14 == 1, "Si",
ifelse(datosMujeres$MEP14 == 2, "No", NA))
head(datosMujeres$MASA17_01)
datosMujeres$GRUPEDAD <- ifelse(datosMujeres$GRUPEDAD==1, "14 a 19 años",
ifelse(datosMujeres$GRUPEDAD == 2, "20 a 29 años",
ifelse(datosMujeres$GRUPEDAD==3, "30 a 39 años",
ifelse(datosMujeres$GRUPEDAD == 4, "40 a 49 años","50 a 59 años"))))
datosMujeresAdult <- datosMujeres[which(datosMujeres$GRUPEDAD != 1),]
datosMujeresAdult$sector <- ifelse(datosMujeresAdult$NIVEL_INSTRUCCION_AGRUPADO < 3, "Popular","Medio/Alto")
datosMujeresAdult= datosMujeresAdult[!is.na(datosMujeresAdult$MEP11),]
totalEND<- nrow(datosMujeres[datosMujeres$MEP11 == "Embarazo no deseado",])
df_corte$canta <- 2013-df_corte$MEP10
summary(df_corte$canta)
df_corte$edadUH <- df_corte$EDAD-df_corte$canta
summary(df_corte$edadUH)
df_corte$GRUPEDAD_UH <- ifelse(df_corte$edadUH<20,"13 a 19 años",
ifelse(df_corte$edadUH<30, "20 a 29 años",
ifelse(df_corte$edadUH<40,"30 a 39 años",
ifelse(df_corte$edadUH<50,"40 a 49 años"))))
end_1 <- nrow(df_corte[df_corte$GRUPEDAD_UH=="13 a 19 años",])
end_2 <- nrow(df_corte[df_corte$GRUPEDAD_UH=="20 a 29 años",])
end_3 <- nrow(df_corte[df_corte$GRUPEDAD_UH=="30 a 39 años",])
end_4 <- nrow(df_corte[df_corte$GRUPEDAD_UH=="40 a 49 años",])
agrup <- c("13 a 19 años","20 a 29 años","30 a 39 años","40 a 49 años")
edades <- c(end_1,end_2,end_3,end_4)
end_grupE <- as.data.frame(cbind(agrup,edades,totalEND))
write.table(end_grupE,file=END_GRUPEDAD.csv, sep=",",col.names=NA)
write.table(end_grupE,file="END_GRUPEDAD.csv", sep=",",col.names=NA)
View(end_grupE)
colnames(end_GRUPE) <- c("id", "grupo","cantidad end","total end")
library(ggplot2)
library(plotly)
library(shiny)
rm(list = ls())
setwd("C:/Users/perla/OneDrive/Documents/ssyr/data")
datosMujeres=read.table("ENSSyR_Mujeres_BaseUsuario.txt", header=T, sep="|")
datosMujeres$MEP11 <- ifelse (datosMujeres$MEP11== 1, "Embarazo deseado","Embarazo no deseado" )
datosMujeres= datosMujeres[!is.na(datosMujeres$MEP11),]
df_corte <- datosMujeres[which (datosMujeres$MEP11=="Embarazo no deseado"),]
datosMujeres$MITS20 <- ifelse(datosMujeres$MITS20 == 1, "Católica",
ifelse(datosMujeres$MITS20 == 2, "Evangélica",
ifelse(datosMujeres$MITS20 == 3, "Judía",
ifelse(datosMujeres$MITS20 == 4, "Testigo de Jeohvá",
ifelse(datosMujeres$MITS20 == 5, "Mormón",
ifelse(datosMujeres$MITS20==7, "Adventista", "Otro"))))))
datosMujeres$MEP05 <- ifelse(datosMujeres$MEP05 == 1, "Si",
ifelse(datosMujeres$MEP05 == 2, "No", NA))
datosMujeres$MEP14 <- ifelse(datosMujeres$MEP14 == 1, "Si",
ifelse(datosMujeres$MEP14 == 2, "No", NA))
head(datosMujeres$MASA17_01)
datosMujeres$GRUPEDAD <- ifelse(datosMujeres$GRUPEDAD==1, "14 a 19 años",
ifelse(datosMujeres$GRUPEDAD == 2, "20 a 29 años",
ifelse(datosMujeres$GRUPEDAD==3, "30 a 39 años",
ifelse(datosMujeres$GRUPEDAD == 4, "40 a 49 años","50 a 59 años"))))
datosMujeresAdult <- datosMujeres[which(datosMujeres$GRUPEDAD != 1),]
datosMujeresAdult$sector <- ifelse(datosMujeresAdult$NIVEL_INSTRUCCION_AGRUPADO < 3, "Popular","Medio/Alto")
datosMujeresAdult= datosMujeresAdult[!is.na(datosMujeresAdult$MEP11),]
totalEND<- nrow(datosMujeres[datosMujeres$MEP11 == "Embarazo no deseado",])
df_corte$canta <- 2013-df_corte$MEP10
summary(df_corte$canta)
df_corte$edadUH <- df_corte$EDAD-df_corte$canta
summary(df_corte$edadUH)
df_corte$GRUPEDAD_UH <- ifelse(df_corte$edadUH<20,"13 a 19 años",
ifelse(df_corte$edadUH<30, "20 a 29 años",
ifelse(df_corte$edadUH<40,"30 a 39 años",
ifelse(df_corte$edadUH<50,"40 a 49 años"))))
end_1 <- nrow(df_corte[df_corte$GRUPEDAD_UH=="13 a 19 años",])
end_2 <- nrow(df_corte[df_corte$GRUPEDAD_UH=="20 a 29 años",])
end_3 <- nrow(df_corte[df_corte$GRUPEDAD_UH=="30 a 39 años",])
end_4 <- nrow(df_corte[df_corte$GRUPEDAD_UH=="40 a 49 años",])
agrup <- c("13 a 19 años","20 a 29 años","30 a 39 años","40 a 49 años")
edades <- c(end_1,end_2,end_3,end_4)
end_grupE <- as.data.frame(cbind(agrup,edades,totalEND))
colnames(end_GRUPE) <- c("id", "grupo","cantidad end","total end")
colnames(end_grupE) <- c("id", "grupo","cantidad end","total end")
View(end_grupE)
write.table(end_grupE,file="END_GRUPEDAD.csv", sep=",",col.names=NA)
p <- plot_ly(end_grupE, labels = ~agrup, values = ~edades, type = 'pie') %>%
layout(title = "¿Los embarazos no deseados son solo una problemática adolescente?",
xaxis = list(showgrid = FALSE, zeroline = FALSE, showticklabels = FALSE),
yaxis = list(showgrid = FALSE, zeroline = FALSE, showticklabels = FALSE))
View(p)
s1 <- nrow(datosMujeresAdult[datosMujeresAdult$sector == "Medio/Alto",])
s2 <- nrow(datosMujeresAdult[datosMujeresAdult$sector == "Popular",])
END_S_1 <- nrow(datosMujeres[datosMujeresAdult$sector == "Medio/Alto" & datosMujeresAdult$MEP11== "Embarazo no deseado",])
END_S_2 <- nrow(datosMujeres[datosMujeresAdult$sector == "Popular" & datosMujeresAdult$MEP11== "Embarazo no deseado",])
embarazosnd_sector <- as.data.frame(rbind(s1,s2))
colnames(embarazosnd_sector)<-c("Cantidad")
embarazosnd_sector$Cant_END <- c(END_S_1,END_S_2)
embarazosnd_sector$tasa <- round(embarazosnd_sector$Cant_END*100/embarazosnd_sector$Cantidad,2)
embarazosnd_sector$total <- c(100)
embarazosnd_sector$sector <- c("Medio/Alto","Popular")
g2<-ggplot(embarazosnd_sector, aes(x="", y=tasa, fill=sector))+geom_bar(width=1,stat="identity")+coord_polar("y", start=0)
plot_ly(embarazosnd_sector, labels = ~sector, values = ~tasa, type = 'pie') %>%
layout(title = "¿Los embarazos no deseados son solo una problemática de mujeres pobres?",
xaxis = list(showgrid = FALSE, zeroline = FALSE, showticklabels = FALSE),
yaxis = list(showgrid = FALSE, zeroline = FALSE, showticklabels = FALSE))
View(embarazosnd_sector)
View(embarazosnd_sector)
View(embarazosnd_sector)
ggplot(df_corte, aes(sector))+geom_bar(aes(fill=factor(MEP14)))
ggplot(datosMujeresAdult, aes(sector))+geom_bar(aes(fill=factor(MEP14)))
datosMujeresAdult_corte <- datosMujeresAdult[which(datosMujeresAdult$MEP11 = "Embarazo no deseado"),]
datosMujeresAdult_corte <- datosMujeresAdult[(datosMujeresAdult$MEP11 = "Embarazo no deseado"),]
View(datosMujeresAdult_corte)
datosMujeresAdult_corte <- datosMujeresAdult[datosMujeresAdult$MEP11 = "Embarazo no deseado",]
datosMujeresAdult_corte <- datosMujeresAdult[datosMujeresAdult$MEP11 == "Embarazo no deseado",]
View(datosMujeresAdult_corte)
datosMujeresAdult_corte <- datosMujeresAdult[(datosMujeresAdult$MEP11 == "Embarazo no deseado"),]
datosMujeresAdult_corte <- datosMujeresAdult[which(datosMujeresAdult$MEP11 == "Embarazo no deseado"),]
View(datosMujeresAdult_corte)
library(ggplot2)
library(plotly)
library(shiny)
rm(list = ls())
setwd("C:/Users/perla/OneDrive/Documents/ssyr/data")
datosMujeres=read.table("ENSSyR_Mujeres_BaseUsuario.txt", header=T, sep="|")
datosMujeres$MEP11 <- ifelse (datosMujeres$MEP11== 1, "Embarazo deseado","Embarazo no deseado" )
datosMujeres= datosMujeres[!is.na(datosMujeres$MEP11),]
df_corte <- datosMujeres[which (datosMujeres$MEP11=="Embarazo no deseado"),]
datosMujeres$MITS20 <- ifelse(datosMujeres$MITS20 == 1, "Católica",
ifelse(datosMujeres$MITS20 == 2, "Evangélica",
ifelse(datosMujeres$MITS20 == 3, "Judía",
ifelse(datosMujeres$MITS20 == 4, "Testigo de Jeohvá",
ifelse(datosMujeres$MITS20 == 5, "Mormón",
ifelse(datosMujeres$MITS20==7, "Adventista", "Otro"))))))
datosMujeres$MEP05 <- ifelse(datosMujeres$MEP05 == 1, "Si",
ifelse(datosMujeres$MEP05 == 2, "No", NA))
datosMujeres$MEP14 <- ifelse(datosMujeres$MEP14 == 1, "Si",
ifelse(datosMujeres$MEP14 == 2, "No", NA))
head(datosMujeres$MASA17_01)
datosMujeres$GRUPEDAD <- ifelse(datosMujeres$GRUPEDAD==1, "14 a 19 años",
ifelse(datosMujeres$GRUPEDAD == 2, "20 a 29 años",
ifelse(datosMujeres$GRUPEDAD==3, "30 a 39 años",
ifelse(datosMujeres$GRUPEDAD == 4, "40 a 49 años","50 a 59 años"))))
datosMujeresAdult <- datosMujeres[which(datosMujeres$GRUPEDAD != "14 a 19 años"),]
datosMujeresAdult$sector <- ifelse(datosMujeresAdult$NIVEL_INSTRUCCION_AGRUPADO < 3, "Popular","Medio/Alto")
datosMujeresAdult= datosMujeresAdult[!is.na(datosMujeresAdult$MEP11),]
df_corte$canta <- 2013-df_corte$MEP10
summary(df_corte$canta)
df_corte$edadUH <- df_corte$EDAD-df_corte$canta
summary(df_corte$edadUH)
df_corte$GRUPEDAD_UH <- ifelse(df_corte$edadUH<20,"13 a 19 años",
ifelse(df_corte$edadUH<30, "20 a 29 años",
ifelse(df_corte$edadUH<40,"30 a 39 años",
ifelse(df_corte$edadUH<50,"40 a 49 años"))))
end_1 <- nrow(df_corte[df_corte$GRUPEDAD_UH=="13 a 19 años",])
end_2 <- nrow(df_corte[df_corte$GRUPEDAD_UH=="20 a 29 años",])
end_3 <- nrow(df_corte[df_corte$GRUPEDAD_UH=="30 a 39 años",])
end_4 <- nrow(df_corte[df_corte$GRUPEDAD_UH=="40 a 49 años",])
agrup <- c("13 a 19 años","20 a 29 años","30 a 39 años","40 a 49 años")
edades <- c(end_1,end_2,end_3,end_4)
end_grupE <- as.data.frame(cbind(agrup,edades,totalEND))
totalEND<- nrow(datosMujeres[datosMujeres$MEP11 == "Embarazo no deseado",])
library(ggplot2)
library(plotly)
library(shiny)
rm(list = ls())
setwd("C:/Users/perla/OneDrive/Documents/ssyr/data")
datosMujeres=read.table("ENSSyR_Mujeres_BaseUsuario.txt", header=T, sep="|")
datosMujeres$MEP11 <- ifelse (datosMujeres$MEP11== 1, "Embarazo deseado","Embarazo no deseado" )
datosMujeres= datosMujeres[!is.na(datosMujeres$MEP11),]
df_corte <- datosMujeres[which (datosMujeres$MEP11=="Embarazo no deseado"),]
datosMujeres$MITS20 <- ifelse(datosMujeres$MITS20 == 1, "Católica",
ifelse(datosMujeres$MITS20 == 2, "Evangélica",
ifelse(datosMujeres$MITS20 == 3, "Judía",
ifelse(datosMujeres$MITS20 == 4, "Testigo de Jeohvá",
ifelse(datosMujeres$MITS20 == 5, "Mormón",
ifelse(datosMujeres$MITS20==7, "Adventista", "Otro"))))))
datosMujeres$MEP05 <- ifelse(datosMujeres$MEP05 == 1, "Si",
ifelse(datosMujeres$MEP05 == 2, "No", NA))
datosMujeres$MEP14 <- ifelse(datosMujeres$MEP14 == 1, "Si",
ifelse(datosMujeres$MEP14 == 2, "No", NA))
head(datosMujeres$MASA17_01)
datosMujeres$GRUPEDAD <- ifelse(datosMujeres$GRUPEDAD==1, "14 a 19 años",
ifelse(datosMujeres$GRUPEDAD == 2, "20 a 29 años",
ifelse(datosMujeres$GRUPEDAD==3, "30 a 39 años",
ifelse(datosMujeres$GRUPEDAD == 4, "40 a 49 años","50 a 59 años"))))
datosMujeresAdult <- datosMujeres[which(datosMujeres$GRUPEDAD != "14 a 19 años"),]
datosMujeresAdult$sector <- ifelse(datosMujeresAdult$NIVEL_INSTRUCCION_AGRUPADO < 3, "Popular","Medio/Alto")
datosMujeresAdult= datosMujeresAdult[!is.na(datosMujeresAdult$MEP11),]
totalEND<- nrow(datosMujeres[datosMujeres$MEP11 == "Embarazo no deseado",])
df_corte$canta <- 2013-df_corte$MEP10
summary(df_corte$canta)
df_corte$edadUH <- df_corte$EDAD-df_corte$canta
summary(df_corte$edadUH)
df_corte$GRUPEDAD_UH <- ifelse(df_corte$edadUH<20,"13 a 19 años",
ifelse(df_corte$edadUH<30, "20 a 29 años",
ifelse(df_corte$edadUH<40,"30 a 39 años",
ifelse(df_corte$edadUH<50,"40 a 49 años"))))
end_1 <- nrow(df_corte[df_corte$GRUPEDAD_UH=="13 a 19 años",])
end_2 <- nrow(df_corte[df_corte$GRUPEDAD_UH=="20 a 29 años",])
end_3 <- nrow(df_corte[df_corte$GRUPEDAD_UH=="30 a 39 años",])
end_4 <- nrow(df_corte[df_corte$GRUPEDAD_UH=="40 a 49 años",])
agrup <- c("13 a 19 años","20 a 29 años","30 a 39 años","40 a 49 años")
edades <- c(end_1,end_2,end_3,end_4)
end_grupE <- as.data.frame(cbind(agrup,edades,totalEND))
write.table(end_grupE,file="END_GRUPEDAD.csv", sep=",",col.names=NA)
p <- plot_ly(end_grupE, labels = ~agrup, values = ~edades, type = 'pie') %>%
layout(title = "¿Los embarazos no deseados son solo una problemática adolescente?",
xaxis = list(showgrid = FALSE, zeroline = FALSE, showticklabels = FALSE),
yaxis = list(showgrid = FALSE, zeroline = FALSE, showticklabels = FALSE))
p
s1 <- nrow(datosMujeresAdult[datosMujeresAdult$sector == "Medio/Alto",])
s2 <- nrow(datosMujeresAdult[datosMujeresAdult$sector == "Popular",])
END_S_1 <- nrow(datosMujeres[datosMujeresAdult$sector == "Medio/Alto" & datosMujeresAdult$MEP11== "Embarazo no deseado",])
END_S_2 <- nrow(datosMujeres[datosMujeresAdult$sector == "Popular" & datosMujeresAdult$MEP11== "Embarazo no deseado",])
embarazosnd_sector <- as.data.frame(rbind(s1,s2))
colnames(embarazosnd_sector)<-c("Cantidad")
embarazosnd_sector$Cant_END <- c(END_S_1,END_S_2)
embarazosnd_sector$tasa <- round(embarazosnd_sector$Cant_END*100/embarazosnd_sector$Cantidad,2)
embarazosnd_sector$total <- c(100)
embarazosnd_sector$sector <- c("Medio/Alto","Popular")
g2<-ggplot(embarazosnd_sector, aes(x="", y=tasa, fill=sector))+geom_bar(width=1,stat="identity")+coord_polar("y", start=0)
plot_ly(embarazosnd_sector, labels = ~sector, values = ~tasa, type = 'pie') %>%
layout(title = "¿Los embarazos no deseados son solo una problemática de mujeres pobres?",
xaxis = list(showgrid = FALSE, zeroline = FALSE, showticklabels = FALSE),
yaxis = list(showgrid = FALSE, zeroline = FALSE, showticklabels = FALSE))
datosMujeresAdult_corte <- datosMujeresAdult[which(datosMujeresAdult$MEP11 == "Embarazo no deseado"),]
ggplot(datosMujeresAdult_corte, aes(sector))+geom_bar(aes(fill=factor(MEP14)))
library(ggplot2)
library(plotly)
library(shiny)
rm(list = ls())
setwd("C:/Users/perla/OneDrive/Documents/ssyr/data")
datosMujeres=read.table("ENSSyR_Mujeres_BaseUsuario.txt", header=T, sep="|")
datosMujeres$MEP11 <- ifelse (datosMujeres$MEP11== 1, "Embarazo deseado","Embarazo no deseado" )
datosMujeres= datosMujeres[!is.na(datosMujeres$MEP11),]
df_corte <- datosMujeres[which (datosMujeres$MEP11=="Embarazo no deseado"),]
datosMujeres$MITS20 <- ifelse(datosMujeres$MITS20 == 1, "Católica",
ifelse(datosMujeres$MITS20 == 2, "Evangélica",
ifelse(datosMujeres$MITS20 == 3, "Judía",
ifelse(datosMujeres$MITS20 == 4, "Testigo de Jeohvá",
ifelse(datosMujeres$MITS20 == 5, "Mormón",
ifelse(datosMujeres$MITS20==7, "Adventista", "Otro"))))))
datosMujeres$MEP05 <- ifelse(datosMujeres$MEP05 == 1, "Si",
ifelse(datosMujeres$MEP05 == 2, "No", NA))
datosMujeres$MEP14 <- ifelse(datosMujeres$MEP14 == 1, "Si",
ifelse(datosMujeres$MEP14 == 2, "No", NA))
head(datosMujeres$MASA17_01)
datosMujeres$GRUPEDAD <- ifelse(datosMujeres$GRUPEDAD==1, "14 a 19 años",
ifelse(datosMujeres$GRUPEDAD == 2, "20 a 29 años",
ifelse(datosMujeres$GRUPEDAD==3, "30 a 39 años",
ifelse(datosMujeres$GRUPEDAD == 4, "40 a 49 años","50 a 59 años"))))
datosMujeresAdult <- datosMujeres[which(datosMujeres$GRUPEDAD != "14 a 19 años"),]
datosMujeresAdult$sector <- ifelse(datosMujeresAdult$NIVEL_INSTRUCCION_AGRUPADO < 3, "Popular","Medio/Alto")
datosMujeresAdult= datosMujeresAdult[!is.na(datosMujeresAdult$MEP11),]
totalEND<- nrow(datosMujeres[datosMujeres$MEP11 == "Embarazo no deseado",])
df_corte$canta <- 2013-df_corte$MEP10
summary(df_corte$canta)
df_corte$edadUH <- df_corte$EDAD-df_corte$canta
summary(df_corte$edadUH)
df_corte$GRUPEDAD_UH <- ifelse(df_corte$edadUH<20,"13 a 19 años",
ifelse(df_corte$edadUH<30, "20 a 29 años",
ifelse(df_corte$edadUH<40,"30 a 39 años",
ifelse(df_corte$edadUH<50,"40 a 49 años"))))
end_1 <- nrow(df_corte[df_corte$GRUPEDAD_UH=="13 a 19 años",])
end_2 <- nrow(df_corte[df_corte$GRUPEDAD_UH=="20 a 29 años",])
end_3 <- nrow(df_corte[df_corte$GRUPEDAD_UH=="30 a 39 años",])
end_4 <- nrow(df_corte[df_corte$GRUPEDAD_UH=="40 a 49 años",])
agrup <- c("13 a 19 años","20 a 29 años","30 a 39 años","40 a 49 años")
edades <- c(end_1,end_2,end_3,end_4)
end_grupE <- as.data.frame(cbind(agrup,edades,totalEND))
write.table(end_grupE,file="END_GRUPEDAD.csv", sep=",",col.names=NA)
p <- plot_ly(end_grupE, labels = ~agrup, values = ~edades, type = 'pie') %>%
layout(title = "¿Los embarazos no deseados son solo una problemática adolescente?",
xaxis = list(showgrid = FALSE, zeroline = FALSE, showticklabels = FALSE),
yaxis = list(showgrid = FALSE, zeroline = FALSE, showticklabels = FALSE))
s1 <- nrow(datosMujeresAdult[datosMujeresAdult$sector == "Medio/Alto",])
s2 <- nrow(datosMujeresAdult[datosMujeresAdult$sector == "Popular",])
END_S_1 <- nrow(datosMujeres[datosMujeresAdult$sector == "Medio/Alto" & datosMujeresAdult$MEP11== "Embarazo no deseado",])
END_S_2 <- nrow(datosMujeres[datosMujeresAdult$sector == "Popular" & datosMujeresAdult$MEP11== "Embarazo no deseado",])
embarazosnd_sector <- as.data.frame(rbind(s1,s2))
colnames(embarazosnd_sector)<-c("Cantidad")
embarazosnd_sector$Cant_END <- c(END_S_1,END_S_2)
embarazosnd_sector$tasa <- round(embarazosnd_sector$Cant_END*100/embarazosnd_sector$Cantidad,2)
embarazosnd_sector$total <- c(100)
embarazosnd_sector$sector <- c("Medio/Alto","Popular")
g2<-ggplot(embarazosnd_sector, aes(x="", y=tasa, fill=sector))+geom_bar(width=1,stat="identity")+coord_polar("y", start=0)
plot_ly(embarazosnd_sector, labels = ~sector, values = ~tasa, type = 'pie') %>%
layout(title = "¿Los embarazos no deseados son solo una problemática de mujeres pobres?",
xaxis = list(showgrid = FALSE, zeroline = FALSE, showticklabels = FALSE),
yaxis = list(showgrid = FALSE, zeroline = FALSE, showticklabels = FALSE))
#¿Qué porcentaje de cada sector usaba anticonceptivos?
datosMujeresAdult_corte <- datosMujeresAdult[which(datosMujeresAdult$MEP11 == "Embarazo no deseado"),]
g4<-ggplot(datosMujeresAdult_corte, aes(sector))+geom_bar(aes(fill=factor(MEP14)))
g4
ggplotly(g4)
g4<-ggplot(datosMujeresAdult_corte, aes(sector))+geom_bar(aes(fill=factor(MEP14),position="fill"))
g4<-ggplot(datosMujeresAdult_corte, aes(sector))+geom_bar(aes(fill=factor(MEP14)),position="fill")
g4
re1 <- nrow(datosMujeres[datosMujeres$MITS20== "Católica",])
re2 <- nrow(datosMujeres[datosMujeres$MITS20== "Evangélica",])
end_re1 <- nrow(datosMujeres[datosMujeres$MITS20 == "Católica" & datosMujeres$MEP11 == "Embarazo no deseado",])
end_re2 <- nrow(datosMujeres[datosMujeres$MITS20 == "Evangélica" & datosMujeres$MEP11 == "Embarazo no deseado",])
re3 <- nrow(datosMujeres[datosMujeres$MITS20 == "Judía",])
end_re3 <- nrow(datosMujeres[datosMujeres$MITS20 == "Judía" & datosMujeres$MEP11 == "Embarazo no deseado",])
religs<-c(re1,re2,re3)
religs_end<-c(end_re1,end_re2,end_re3)
end_porrelig <- as.data.frame(cbind(religs,religs_end))
View(end_porrelig)
View(end_porrelig)
cant_religs<-c(re1,re2,re3)
end_porrelig <- as.data.frame(cbind(cant_religs,religs_end))
end_porrelig$relig<-c("Católicas","Evangélicas","Judías")
View(end_porrelig)
View(end_porrelig)
ggplot(end_porrelig,aes(cant_religs))+geom_bar(aes(fill=religs_end))
setwd("C:/Users/perla/OneDrive/Documents/ssyr/data")
datosMujeres=read.table("ENSSyR_Mujeres_BaseUsuario.txt", header=T, sep="|")
END=read.table("END.csv", header=T, sep=",")
END$MEP14= ifelse(END$MEP14 == 1, "Sí",
ifelse(END$MEP14 == 2, "No", NA))
END_ADULT=read.table("END_ADULT.csv", header=T, sep=",")
END_EDAD=read.table("END_GRUPEDAD.csv", header=T, sep=",")
colnames(END_EDAD)=c("id","grupo","cantgrupo","cantidad total")
END_RELIG=read.table("END_RELIG.csv", header=T, sep=",")
colnames(END_RELIG)[1]=c("id")
END_SECTOR=read.table("END_SECTOR.csv", header=T, sep=",")
colnames(END_SECTOR)[1]=c("id")
END_UA<- read.table("END_UA.csv", header=T, sep=",")
colnames(END_UA) <- c("Cat","Cant","Total")
END_UA$Cat <- ifelse(END_UA$Cat == "ua", "Usaba anticonceptivos","No usaba anticonceptivos")
colnames(END_EDAD)=c("id","grupo","cantgrupo","total")
ggplot(END_EDAD, aes(x= (total,-cantgrupo),y=cantgrupo,fill=factor(grupo)))+geom_bar(position="dodge")
ggplot(END_EDAD, aes(x= reorder(total,-cantgrupo),y=cantgrupo,fill=factor(grupo)))+geom_bar(position="dodge")
library(ggplot2)
library(plotly)
library(shiny)
ggplot(END_EDAD, aes(x= reorder(total,-cantgrupo),y=cantgrupo,fill=factor(grupo)))+geom_bar(position="dodge")
ggplot(END, aes(x= MEP11,fill=factor(GRUPEDAD_UH)))+geom_bar(position="dodge")
ggplot(END, aes(x= reorder(MEP11),fill=factor(GRUPEDAD_UH)))+geom_bar(position="dodge")
ggplot(END, aes(x= MEP11,fill=factor(GRUPEDAD_UH)))+geom_bar(position="dodge")
ggplot(END_EDAD, aes(x= grupo, y=cantgrupo))+geom_bar(position="dodge")
ggplot(END, aes(x= MEP11,fill=factor(GRUPEDAD_UH)))+geom_bar(position="dodge")
ggplot(END_EDAD, aes(x= grupo,y=cantgrupo))+geom_bar()
ggplot(END_EDAD, aes(x= grupo,y=END_EDAD$cantgrupo))+geom_bar()
ggplot(END_EDAD, aes(x= grupo,y=END_EDAD$cantgrupo))+geom_bar(stat="identity")
ggplot(END_EDAD, aes(x= grupo,y=cantgrupo))+geom_bar(stat="identity")
ggplot(END_EDAD, aes(x= reorder(grupo,-cantgrupo),y=cantgrupo))+geom_bar(stat="identity")
server=function(input,output){
output$grafEdad=renderPlot({
ggplot(END_EDAD, aes(x= reorder(grupo,-cantgrupo),y=cantgrupo))+geom_bar(stat="identity")
})
output$grafClase=renderPlotly({
plot_ly(END_SECTOR, labels = ~sector, values = ~tasa, type = 'pie') %>%
layout(
xaxis = list(showgrid = FALSE, zeroline = FALSE, showticklabels = FALSE),
yaxis = list(showgrid = FALSE, zeroline = FALSE, showticklabels = FALSE))
})
output$grafClase1 = renderPlot ({
ggplot(datosMujeresAdult, aes(sector))+geom_bar(aes(fill=factor(MEP14)),position = 'dodge')
})
output$grafusoA=renderPlotly({
plot_ly(END_UA, labels = ~Cat, values = ~Cant, type = 'pie') %>%
layout(xaxis = list(showgrid = FALSE, zeroline = FALSE, showticklabels = FALSE),
yaxis = list(showgrid = FALSE, zeroline = FALSE, showticklabels = FALSE))
})
output$grafRelig=renderPlotly({
plot_ly(END_RELIG, labels = ~Categoria, values = ~Tasa, type = 'pie') %>%
layout(xaxis = list(showgrid = FALSE, zeroline = FALSE, showticklabels = FALSE),
yaxis = list(showgrid = FALSE, zeroline = FALSE, showticklabels = FALSE))
})
output$tablaEdad=renderTable({END_EDAD})
output$tablaClase=renderTable({END_SECTOR})
# 6.15) El ultimo paso es el boton que escribe el archivo!
#  output$download_data <- downloadHandler(
#    filename = "pelis_data.csv",
#    content = function(file) {
#      data <- base()
#      write.csv(data, file, row.names = FALSE)
#    }
#  )
}
shinyApp(ui = ui, server = server)
ui=fluidPage (
titlePanel("Trabajo final EANT"),
tabsetPanel(
tabPanel(strong('Introducción'),
p(h5("En los últimos años se puso en la mesa el debate sobre la despenalización del aborto y la incidencia que tendría en el país. Las mujeres de sectores populares de la población, frente un embarazo no deseado, recurren a un aborto clandestino en condiciones que probablemente les conlleven complicaciones médicas o la muerte. Que el Estado sea garante de un aborto en condiciones seguras y de sanidad se corresponde a la obligación de este de garantizar el derecho a la salud de toda la población.")),
p(h5("Ahora, cuando unx habla de un embarazo no deseado, generalmente se imagina el caso de una adolescente (que no se cuidó a la hora de tener relaciones), que es demasiado joven para ser madre y no tiene los recursos para criar un hijo. Una mujer adulta, con el capital económico suficiente para criar un hijo, está lista para ser madre y por lo tanto debería serlo. El objetivo de este trabajo es mostrar que esta ideal de maternidad impuesto a las mujeres no se corresponde a la realidad.")),
p(h5("Los datos fueron tomados de la Encuesta de Salud Sexual y Reproductiva del Ministerio de Salud realizada en 2013. La pregunta clave fue: [Respecto al último hijo nacido vivo]")),
p(h5(strong("Cuando quedó embarazada, ¿quería tener ese hijo, quería esperar más tiempo o no quería tener ese hijo? ")),
p(h5("Las opciones de respuesta eran:")),
p(h5("1)	Quería tenerlo")),
p(h5("2)	Quería esperar")),
p(h5("3)	No quería hijos/Más hijos")),
p(h5("Clasifiqué las unidades de análisis en Embarazo deseado si habían contestado 1, y en Embarazo no deseado si habían contestado 2 o 3. ")))
),
tabPanel(strong('Gráficos'),
navlistPanel('Analisis según:',
tabPanel('Edad',
h2(strong("¿Los embarazos no deseados son solo una problemática adolescente?")),
p("El primer punto es la edad. En base a las preguntas de edad de la encuestada y año de nacimiento de su último hijo vivo, calculé la edad a la que habían quedado embarazadas y clasifiqué en cuatro grupos:"),
br(),
tableOutput('tablaEdad'),
br(),
plotOutput('grafEdad'),
br(),
p("Del total de embarazos no deseados, el grupo que tiene más peso es el de las mujeres que quedaron embarazadas entre los 20 y 29 años. ")
),
tabPanel('Clase',
h2(strong("¿Los embarazos no deseados son solo una problemática de mujeres pobres?")),
p(""),
tableOutput('tablaClase'),
plotlyOutput('grafClase'),
plotOutput('grafClase1')
),
tabPanel('Uso de anticonceptivos',
plotlyOutput('grafusoA')
),
tabPanel('Religión',
plotlyOutput('grafRelig')
)
))
)
)
shinyApp(ui = ui, server = server)
